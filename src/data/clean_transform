import os
from pathlib import Path

import pandas as pd

RAW_DIR = Path("data/raw")
PROCESSED_DIR = Path("data/processed")
CORPUS_PATH = PROCESSED_DIR / "corpus.parquet"


def main():
    """
    Read raw documents and build a cleaned, chunked text corpus.

    For now, this creates an empty corpus with the right columns.
    Later you will:
      - read pdf or ppt files
      - extract text
      - split into chunks
      - fill the dataframe
    """
    PROCESSED_DIR.mkdir(parents=True, exist_ok=True)

    df = pd.DataFrame(
        columns=[
            "id",        # unique chunk id
            "source",    # file name or url
            "page",      # page number if pdf
            "chunk_id",  # chunk index inside the page or file
            "text",      # text content of the chunk
        ]
    )

    df.to_parquet(CORPUS_PATH)
    print(f"Empty corpus saved to: {CORPUS_PATH.resolve()}")


if __name__ == "__main__":
    main()
